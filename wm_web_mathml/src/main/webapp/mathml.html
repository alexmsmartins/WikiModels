<lift:surround with="default" at="content">

    <div id="some-div">
        <h2>MahtML Editor is below this.</h2>

        <head>
          <script id="xslttransform" type="text/javascript">
          /* <![CDATA[ */
           //TODO - COPY THIS CODE TO A FILE
            function loadXMLDoc(dname)
            {
            $.log("Executando loadXMLDoc(dname)")
            if (window.XMLHttpRequest)
              {
              xhttp=new XMLHttpRequest();
              }
            else
              {
              xhttp=new ActiveXObject("Microsoft.XMLHTTP");
              }
            xhttp.open("GET",dname,false);
            xhttp.send("");
            return xhttp.responseXML;
            }

            function displayResult()
            {
            xml=$("#ondivload2").html();

            xsl=loadXMLDoc("/xslt/mathmlc2p.xsl");

            $.log("Content mathml in page is " + $("#ondivload2").html() );

          //TODO - change xslt conversion to the jQeury plugin from http://www.jongma.org/webtools/jquery/xslt/
          // code for IE
          if (window.ActiveXObject)
            {
            ex=xml.transformNode(xsl);
            document.getElementById("ondivload2").innerHTML=ex;
            }
          // code for Mozilla, Firefox, Opera, etc.
          else if (document.implementation && document.implementation.createDocument)
            {
            xsltProcessor=new XSLTProcessor();
            xsltProcessor.importStylesheet(xsl);
            resultDocument = xsltProcessor.transformToFragment(xml,document);
            $.log("Content mathml in page is " + resultDocument.html() );
            document.getElementById("ondivload2").appendChild(resultDocument);
            }
           }
          /* ]]> */
          </script>
        </head>
        <div>
            <lift:MathMLEdit form="POST">
                <script type="text/javascript">
                    /* <![CDATA[ */
                    $(document).ready(function(){
                      displayResult();
                    });
                    /* ]]> */
                </script>
                <script id="mathjax" src="/MathJax/MathJax.js" type="text/javascript">
                    /* <![CDATA[ */
                    $(document).ready(function() {
                      MathJax.Hub.Config({
                        config: ["MMLorHTML.js"],
                        extensions: ["tex2jax.js", "mml2jax.js"],
                        jax: ["input/TeX", "input/MathML"]
                      });
                    });
                    /* ]]> */
                </script>

                <lift:ignore>
                    <!-- TODO LEARN error messages from the framework -->
                </lift:ignore>
                <lift:msgs id="parsing_error"/>

                <link rel="stylesheet" type="text/css" href="css/mathml_editor.css"/>
                <a href="http://www1.chapman.edu/~jipsen/asciimath.html">Help with AsciiMathML</a>

                <p id="parse_success" class="success">Parsing succeded</p>
                <p id="parse_failed" class="error"> Error parsing AsciiMathML</p>
                <div>
                    <visualizer:formulaViz>
                        <span id="form_viz"></span>
                    </visualizer:formulaViz>
                    <editor:formula/>
                </div>
                <br/>
                <br/>
                <br/>
                <br/>
                <br/>
                <br/>
                <br/>
                <br/>
                <br/>
                <editor:submit />
            </lift:MathMLEdit>
        </div>
    </div>
    <!-- end of "some-div"-->
</lift:surround>
